<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Your GeniusPet order is confirmed. Here's your safety plan summary.">
  <title>Order Confirmed — GeniusPet</title>
  <link rel="icon" type="image/svg+xml" href="images/favicon.svg">
  <link rel="stylesheet" href="css/fonts.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'brand-red': '#C94A4A',
            'brand-red-dark': '#8B3535',
            'brand-beige': '#E8E0D8',
            'brand-beige-light': '#F5F0EB',
            'brand-beige-mid': '#EDE8E3',
            'brand-tan': '#D4A76A',
            'brand-blue': '#2E7D9A',
            'brand-blue-dark': '#246A85',
            'brand-blue-light': '#E8F4F8',
          },
          fontFamily: {
            'gilroy': ['Gilroy', '-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'sans-serif'],
          },
        },
      },
    }
  </script>
  <style>
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(12px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .fade-in-up {
      animation: fadeInUp 0.5s ease-out forwards;
      opacity: 0;
    }
    .fade-in-up-1 { animation-delay: 0.1s; }
    .fade-in-up-2 { animation-delay: 0.25s; }
    .fade-in-up-3 { animation-delay: 0.4s; }
    .fade-in-up-4 { animation-delay: 0.55s; }

    @keyframes scoreCountUp {
      from { opacity: 0.3; }
      to { opacity: 1; }
    }

    @keyframes barFill {
      from { width: 0%; }
    }
    .bar-animate {
      animation: barFill 1.2s ease-out 0.6s forwards;
    }
  </style>
</head>
<body class="font-gilroy text-gray-800 bg-white antialiased">

  <!-- Header -->
  <header class="bg-white py-4 border-b border-brand-beige-mid">
    <div class="max-w-[600px] mx-auto px-5">
      <div class="flex items-center justify-center gap-2">
        <img src="images/home2-logo.svg" alt="GeniusPet" class="h-7 w-auto">
      </div>
    </div>
  </header>

  <!-- Confirmation Hero -->
  <section class="pt-8 pb-6 bg-brand-beige-light/50">
    <div class="max-w-[600px] mx-auto px-5 text-center">

      <!-- Checkmark -->
      <div class="w-16 h-16 rounded-full bg-green-50 mx-auto flex items-center justify-center mb-4 fade-in-up fade-in-up-1">
        <svg class="w-8 h-8 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
          <path d="M5 13l4 4L19 7"/>
        </svg>
      </div>

      <h1 class="text-2xl font-bold text-gray-900 mb-2 fade-in-up fade-in-up-1">You're all set, <span id="pet-name-hero" class="text-brand-blue">your pet</span>!</h1>
      <p class="text-[15px] text-gray-500 mb-0 fade-in-up fade-in-up-2">Your order is confirmed. Here's your protection summary.</p>
    </div>
  </section>

  <!-- Final Safety Score -->
  <section class="py-6 bg-white">
    <div class="max-w-[600px] mx-auto px-5">
      <div class="bg-white rounded-2xl shadow-sm border border-brand-beige-mid p-5 fade-in-up fade-in-up-2">
        <div class="text-center mb-4">
          <p class="text-[11px] font-semibold uppercase tracking-[0.08em] text-gray-400 mb-1">Final Pet Safety Score</p>
          <span id="final-score" class="block text-[56px] font-extrabold text-brand-blue leading-none">54</span>
          <span id="status-label" class="inline-block text-[11px] font-bold uppercase tracking-wide px-3 py-1 rounded-full mt-2 bg-orange-100 text-orange-700">At Risk</span>
        </div>

        <!-- Score Bar -->
        <div class="h-2.5 bg-gray-100 rounded-full overflow-hidden mb-4">
          <div id="score-bar" class="h-full rounded-full bar-animate" style="width: 54%; background: linear-gradient(90deg, #2E7D9A, #4CAF50);"></div>
        </div>

        <!-- What's Protected -->
        <div id="products-list" class="space-y-2">
          <!-- Dynamically populated by JS -->
        </div>
      </div>
    </div>
  </section>

  <!-- What Happens Next -->
  <section class="py-6 bg-brand-beige-light/50">
    <div class="max-w-[600px] mx-auto px-5">
      <div class="fade-in-up fade-in-up-3">
        <h2 class="text-lg font-bold text-gray-900 mb-4 text-center">What happens next</h2>

        <div class="space-y-3">
          <!-- Step 1: Tag Ships -->
          <div class="flex items-start gap-3 bg-white rounded-xl p-4 shadow-sm border border-brand-beige-mid">
            <div class="w-8 h-8 rounded-full bg-brand-blue/10 flex items-center justify-center flex-shrink-0 mt-0.5">
              <svg class="w-4 h-4 text-brand-blue" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/>
              </svg>
            </div>
            <div>
              <p class="text-sm font-bold text-gray-900 mb-0.5">GeniusTag ships today</p>
              <p class="text-[13px] text-gray-500 m-0">Arrives in 2-3 business days. Free shipping included.</p>
            </div>
          </div>

          <!-- Step 2: Profile -->
          <div class="flex items-start gap-3 bg-white rounded-xl p-4 shadow-sm border border-brand-beige-mid">
            <div class="w-8 h-8 rounded-full bg-brand-blue/10 flex items-center justify-center flex-shrink-0 mt-0.5">
              <svg class="w-4 h-4 text-brand-blue" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
              </svg>
            </div>
            <div>
              <p class="text-sm font-bold text-gray-900 mb-0.5">Set up your pet's profile</p>
              <p class="text-[13px] text-gray-500 m-0">When your tag arrives, scan the QR code to activate. Takes 3 minutes.</p>
            </div>
          </div>

          <!-- Step 3: Protected -->
          <div class="flex items-start gap-3 bg-white rounded-xl p-4 shadow-sm border border-brand-beige-mid">
            <div class="w-8 h-8 rounded-full bg-green-50 flex items-center justify-center flex-shrink-0 mt-0.5">
              <svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
              </svg>
            </div>
            <div>
              <p class="text-sm font-bold text-gray-900 mb-0.5">You're protected</p>
              <p class="text-[13px] text-gray-500 m-0">Anyone who finds <span class="pet-name">your pet</span> can instantly reach you. No app needed.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Order Summary -->
  <section class="py-6 bg-white">
    <div class="max-w-[600px] mx-auto px-5">
      <div class="fade-in-up fade-in-up-4">
        <h2 class="text-lg font-bold text-gray-900 mb-4 text-center">Order summary</h2>

        <div class="bg-white rounded-2xl shadow-sm border border-brand-beige-mid overflow-hidden">
          <div id="order-items" class="divide-y divide-gray-100">
            <!-- Dynamically populated by JS -->
          </div>
          <div class="flex items-center justify-between px-5 py-3 bg-gray-50">
            <span class="text-sm font-bold text-gray-900">Total today</span>
            <span id="order-total" class="text-sm font-bold text-gray-900">$6.99</span>
          </div>
        </div>

        <p id="recurring-note" class="text-[12px] text-gray-400 text-center mt-2 hidden"></p>
      </div>
    </div>
  </section>

  <!-- Confirmation email note -->
  <section class="py-6 bg-brand-beige-light/50">
    <div class="max-w-[600px] mx-auto px-5 text-center">
      <div class="fade-in-up fade-in-up-4">
        <div class="flex items-center justify-center gap-2 mb-2">
          <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
          </svg>
          <span class="text-sm text-gray-500">A confirmation email is on its way</span>
        </div>
        <p id="email-display" class="text-[13px] text-gray-400"></p>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="py-8 bg-[#1A1A1A] text-gray-500">
    <div class="max-w-[600px] mx-auto px-5">
      <div class="flex items-center justify-center gap-2 mb-4">
        <img src="images/home2-logo.svg" alt="GeniusPet" class="h-6 w-auto brightness-0 invert">
      </div>
      <p class="text-sm text-center text-gray-500">&copy; 2026 GeniusPet. All rights reserved.</p>
    </div>
  </footer>

  <script>
  (function() {
    'use strict';

    // --- Score functions ---
    function computeScore(products) {
      var lp = 12, hp = 7, ec = 8;
      if (products.geniusTag)          { lp += 18; hp += 2; ec += 11; }
      if (products.advancedProtection) { lp += 4;  ec += 9; }
      if (products.teleVet)            { hp += 10; }
      if (products.insurance)          { lp += 5;  hp += 6; ec += 3; }
      lp = Math.min(lp, 40); hp = Math.min(hp, 30); ec = Math.min(ec, 30);
      return { lostPet: lp, health: hp, emergency: ec, total: lp + hp + ec };
    }
    function getStatusLabel(score) {
      if (score >= 88) return { label: 'Fully Protected', cls: 'bg-green-100 text-green-700' };
      if (score >= 78) return { label: 'Good', cls: 'bg-blue-100 text-blue-700' };
      if (score >= 65) return { label: 'Improving', cls: 'bg-amber-100 text-amber-700' };
      if (score >= 50) return { label: 'At Risk', cls: 'bg-orange-100 text-orange-700' };
      return { label: 'High Risk', cls: 'bg-red-100 text-red-700' };
    }

    // 1. Get pet name
    var petName = 'your pet';
    var sessionData = sessionStorage.getItem('petProfile');
    if (sessionData) {
      try {
        var parsed = JSON.parse(sessionData);
        if (parsed.name) petName = parsed.name;
      } catch (e) {}
    }
    var urlParams = new URLSearchParams(window.location.search);
    var urlName = urlParams.get('name');
    var urlEmail = urlParams.get('email');
    if (urlName && petName === 'your pet') petName = urlName;

    // 2. Read products from sessionStorage
    var defaultProducts = { geniusTag: true, advancedProtection: false, teleVet: false, insurance: false };
    var scoreState = { products: defaultProducts };
    var stored = sessionStorage.getItem('safetyScore');
    if (stored) {
      try { scoreState = JSON.parse(stored); } catch (e) {}
    }
    if (!scoreState.products) scoreState.products = defaultProducts;
    var products = scoreState.products;

    // 3. Compute final score
    var finalScore = computeScore(products);
    var status = getStatusLabel(finalScore.total);

    // 4. Populate hero
    var heroEl = document.getElementById('pet-name-hero');
    if (heroEl) heroEl.textContent = petName;
    document.querySelectorAll('.pet-name').forEach(function(el) {
      el.textContent = petName;
    });

    // 5. Populate final score
    var scoreEl = document.getElementById('final-score');
    var statusEl = document.getElementById('status-label');
    var scoreBar = document.getElementById('score-bar');
    if (scoreEl) scoreEl.textContent = finalScore.total;
    if (statusEl) {
      statusEl.textContent = status.label;
      statusEl.className = 'inline-block text-[11px] font-bold uppercase tracking-wide px-3 py-1 rounded-full mt-2 ' + status.cls;
    }
    if (scoreBar) scoreBar.style.width = finalScore.total + '%';

    // 6. Build products list
    var productsList = document.getElementById('products-list');
    var productEntries = [
      { key: 'geniusTag', name: 'GeniusTag Smart Pet ID', desc: 'Instant contact when scanned', icon: 'tag' },
      { key: 'advancedProtection', name: 'Advanced Protection', desc: 'Instant alerts + recovery network', icon: 'shield' },
      { key: 'teleVet', name: 'TeleVet 24/7', desc: '24/7 licensed vet access', icon: 'phone' },
      { key: 'insurance', name: 'Pet Insurance', desc: 'Emergency financial coverage', icon: 'heart' }
    ];

    var iconSVGs = {
      tag: '<svg class="w-4 h-4 text-brand-blue" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/></svg>',
      shield: '<svg class="w-4 h-4 text-brand-blue" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>',
      phone: '<svg class="w-4 h-4 text-brand-blue" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/></svg>',
      heart: '<svg class="w-4 h-4 text-brand-blue" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/></svg>'
    };

    productEntries.forEach(function(entry) {
      var isPurchased = products[entry.key];
      var div = document.createElement('div');
      div.className = 'flex items-center gap-3 py-2';

      if (isPurchased) {
        div.innerHTML =
          '<div class="w-7 h-7 rounded-full bg-green-50 flex items-center justify-center flex-shrink-0">' +
            '<svg class="w-3.5 h-3.5 text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>' +
          '</div>' +
          '<div class="flex-1">' +
            '<p class="text-sm font-semibold text-gray-900 m-0">' + entry.name + '</p>' +
            '<p class="text-[12px] text-gray-500 m-0">' + entry.desc + '</p>' +
          '</div>' +
          '<span class="text-[11px] font-bold text-green-600 flex-shrink-0">Active</span>';
      } else {
        div.innerHTML =
          '<div class="w-7 h-7 rounded-full bg-gray-100 flex items-center justify-center flex-shrink-0">' +
            '<svg class="w-3.5 h-3.5 text-gray-300" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/></svg>' +
          '</div>' +
          '<div class="flex-1">' +
            '<p class="text-sm text-gray-400 m-0">' + entry.name + '</p>' +
            '<p class="text-[12px] text-gray-300 m-0">' + entry.desc + '</p>' +
          '</div>' +
          '<span class="text-[11px] text-gray-300 flex-shrink-0">Not added</span>';
      }
      productsList.appendChild(div);
    });

    // 7. Build order summary
    var orderItems = document.getElementById('order-items');
    var orderTotal = document.getElementById('order-total');
    var recurringNote = document.getElementById('recurring-note');
    var totalToday = 6.99; // GeniusTag always purchased
    var recurringItems = [];

    function addOrderLine(name, price, note) {
      var div = document.createElement('div');
      div.className = 'flex items-center justify-between px-5 py-3';
      div.innerHTML =
        '<div>' +
          '<p class="text-sm text-gray-900 font-medium m-0">' + name + '</p>' +
          (note ? '<p class="text-[12px] text-gray-400 m-0">' + note + '</p>' : '') +
        '</div>' +
        '<span class="text-sm font-medium text-gray-900">' + price + '</span>';
      orderItems.appendChild(div);
    }

    // GeniusTag (always)
    addOrderLine('GeniusTag Smart Pet ID', '$6.99', 'One-time · Free shipping');

    // Advanced Protection
    if (products.advancedProtection) {
      var advData = sessionStorage.getItem('advancedPurchased');
      var advPlan = 'annual';
      var advPrice = '$89.00';
      var advNote = 'Billed annually';
      if (advData) {
        try {
          var advParsed = JSON.parse(advData);
          if (advParsed.plan === 'quarterly') {
            advPrice = '$14.85';
            advNote = 'Billed quarterly';
          }
        } catch (e) {}
      }
      addOrderLine('Advanced Protection', advPrice, advNote);
      totalToday += (advNote === 'Billed quarterly' ? 14.85 : 89.00);
      recurringItems.push('Advanced Protection');
    }

    // TeleVet
    if (products.teleVet) {
      addOrderLine('TeleVet 24/7', '$47.94', 'Billed bi-annually');
      totalToday += 47.94;
      recurringItems.push('TeleVet');
    }

    // Insurance
    if (products.insurance) {
      var insData = sessionStorage.getItem('insurancePurchased');
      var insPlan = 'Complete';
      var insPrice = '$39.99/mo';
      if (insData) {
        try {
          var insParsed = JSON.parse(insData);
          if (insParsed.plan) insPlan = insParsed.plan.charAt(0).toUpperCase() + insParsed.plan.slice(1);
          if (insParsed.price) insPrice = insParsed.price + '/mo';
        } catch (e) {}
      }
      addOrderLine('Pet Insurance (' + insPlan + ')', insPrice, 'Billed monthly');
      recurringItems.push('Insurance');
    }

    // Update total
    if (orderTotal) orderTotal.textContent = '$' + totalToday.toFixed(2);

    // Show recurring note if applicable
    if (recurringItems.length > 0 && recurringNote) {
      recurringNote.classList.remove('hidden');
      recurringNote.textContent = 'Recurring subscriptions can be cancelled anytime from your account.';
    }

    // 8. Show email
    var emailDisplay = document.getElementById('email-display');
    if (emailDisplay && urlEmail) {
      emailDisplay.textContent = 'Sent to ' + urlEmail;
    }

    // 9. Animate score count-up
    if (scoreEl) {
      var target = finalScore.total;
      var current = 0;
      var startTime = performance.now();
      var duration = 1200;
      function animateScore(now) {
        var elapsed = now - startTime;
        var progress = Math.min(elapsed / duration, 1);
        var eased = 1 - Math.pow(1 - progress, 3);
        current = Math.round(target * eased);
        scoreEl.textContent = current;
        if (progress < 1) requestAnimationFrame(animateScore);
      }
      setTimeout(function() {
        requestAnimationFrame(animateScore);
      }, 400);
    }

  })();
  </script>
</body>
</html>
